function RcAnalyticsEvents(){var publicValues=this;var privateValues={};privateValues.moduleUrl=prestashop.urls.base_url+'modules/rc_pganalytics/';privateValues.redirected=!1;privateValues.redirectLink=null;privateValues.productsPosition={};privateValues.initial=!0;privateValues.sendProducts=[];privateValues.sentProducts=[];privateValues.scrollTimeout=null;privateValues.lastIdProductView='';privateValues.doNotTrack=(window.doNotTrack=="1"||navigator.doNotTrack=="yes"||navigator.doNotTrack=="1"||navigator.msDoNotTrack=="1");publicValues.trackingFeatures=null;publicValues.lists=null;publicValues.productsListCache=null;publicValues.ecommPageType='';publicValues.controllerName='';publicValues.isCheckout='';publicValues.compliantModuleName='';publicValues.opcEventName='payment / shipping';publicValues.eventScrollList=eventScrollList;publicValues.eventClickProductList=eventClickProductList;publicValues.eventProductView=eventProductView;publicValues.eventSocialShareProductView=eventSocialShareProductView;publicValues.eventAddCartProduct=eventAddCartProduct;publicValues.eventCartQuantityUp=eventCartQuantityUp;publicValues.eventCartQuantityDown=eventCartQuantityDown;publicValues.eventCartQuantityDelete=eventCartQuantityDelete;publicValues.eventPrestashopCheckout=eventPrestashopCheckout;publicValues.eventOpcSuperCheckout=eventOpcSuperCheckout;publicValues.eventCartOpcSupercheckout=eventCartOpcSupercheckout;publicValues.onSearchResults=onSearchResults;publicValues.onCheckoutProducts=onCheckoutProducts;publicValues.onAddOrder=onAddOrder;publicValues.onSignUp=onSignUp;publicValues.sendGtagConfig=sendGtagConfig;publicValues.setClientId=setClientIdInDb;if(RcAnalyticsEvents.prototype.getInstance){return RcAnalyticsEvents.prototype.getInstance}
RcAnalyticsEvents.prototype.getInstance=this;function eventScrollList(){if(!privateValues.initial){clearTimeout(privateValues.scrollTimeout);scrollProductDetection();privateValues.scrollTimeout=setTimeout(function(){if(privateValues.sendProducts.length){doneScroll()}},800)}else{privateValues.initial=!1;scrollProductDetection();doneScroll()}}
function eventClickProductList(event){var mainSelector=['.js-product-miniature'];var variantSelector=['.js-product-miniature .variant-links a'];var eventSelectors=['.js-product-miniature .product-thumbnail','.js-product-miniature .product-title a','.js-product-miniature .variant-links a','.js-product-miniature .quick-view'];var target=delegateEvents(eventSelectors,event.target);var caseClick=1;var classList;var link;var productNode;var variantNode;var variantAttribute;var idProduct;var idProductAttribute;var list;if(event.button===0&&target&&target.nodeName==='A'&&window.ga&&window.ga.loaded){if(!event.ctrlKey&&!event.shiftKey){link=target.getAttribute('href');if(link){event.preventDefault()}}
classList=target.classList;productNode=delegateEvents(mainSelector,target);variantNode=delegateEvents(variantSelector,target);if(productNode){idProduct=parseInt(productNode.getAttribute('data-id-product'));idProductAttribute=parseInt(productNode.getAttribute('data-id-product-attribute'))}
list=checkFilters();if(!isNaN(idProduct)){if(classList.contains('quick-view')||classList.contains('quick-view-mobile')){link=null}
if(variantNode){variantAttribute=variantNode.getAttribute('data-id-product-attribute');if(variantAttribute){idProductAttribute=variantAttribute}}
if(isNaN(idProductAttribute)){idProductAttribute=0}
idProduct=idProduct+'-'+idProductAttribute;getData(caseClick,idProduct,list,link,null)}else{document.location=link}}}
function eventProductView(event){var caseClick=4;var productListView=publicValues.lists.productView;var productDetailsNode;var productDetails;var idProductValue;var idProductAttributeValue;var idProductView;if(document.body.id!=='product'){if(event&&event.dataset){idProductValue=event.dataset.idProduct;idProductAttributeValue=event.dataset.idProductAttribute}else{idProductValue=document.querySelector('#product_page_product_id').value;idProductAttributeValue=event.id_product_attribute}
productListView='quick_view'}else{productDetailsNode=document.querySelector('#product-details');productDetails=JSON.parse(productDetailsNode.dataset.product);idProductValue=productDetails.id_product;idProductAttributeValue=productDetails.id_product_attribute}
idProductView=idProductValue+'-'+idProductAttributeValue;if(idProductView!==privateValues.lastIdProductView){getData(caseClick,idProductView,productListView,null,null);privateValues.lastIdProductView=idProductView}}
function eventSocialShareProductView(event){var eventSelectors=['.facebook','.twitter','.googleplus','.pinterest'];var target=delegateEvents(eventSelectors,event.target);var network;if(event.button===0&&target&&window.ga&&window.ga.loaded){if(target){eventSelectors.forEach(function(platform){platform=platform.substring(1);if(target.classList.contains(platform)){network=platform}});if(network){onSocialAction(network)}}}}
function eventAddCartProduct(event){var caseClick=2;var productViewList=publicValues.lists.productView;var idProduct;var idProductAttribute;var quantityWanted;var quickViewModal;if(event&&event.reason&&document.body.id!=='cart'){quickViewModal=document.querySelector('[id^=quickview-modal]');if(quickViewModal){productViewList='quick_view'}
idProduct=parseInt(event.reason.idProduct);idProductAttribute=parseInt(event.reason.idProductAttribute);if(document.body.id==='product'||quickViewModal){quantityWanted=parseInt(document.querySelector('#quantity_wanted').value)}else{quantityWanted=1}
if(!isNaN(idProduct)&&!isNaN(quantityWanted)){if(isNaN(idProductAttribute)){idProductAttribute=0}
idProduct=idProduct+'-'+idProductAttribute;getData(caseClick,idProduct,productViewList,null,quantityWanted)}}}
function eventCartQuantityUp(event){var eventSelectors=['.js-increase-product-quantity'];var mainSelector=['.cart-item'];var target=delegateEvents(eventSelectors,event.target);var caseClick=2;var quantityWanted=1;var mainNode;var dataNode;var idProduct;var idProductAttribute;if(event.button===0&&target&&ga.loaded){mainNode=delegateEvents(mainSelector,target);dataNode=mainNode.querySelector('.remove-from-cart');if(dataNode){idProduct=parseInt(dataNode.getAttribute('data-id-product'));idProductAttribute=parseInt(dataNode.getAttribute('data-id-product-attribute'))}
if(!isNaN(idProduct)){if(isNaN(idProductAttribute)){idProductAttribute=0}
idProduct=idProduct+'-'+idProductAttribute;getData(caseClick,idProduct,publicValues.lists.default,null,quantityWanted)}}}
function eventCartQuantityDown(event){var eventSelectors=['.js-decrease-product-quantity'];var mainSelector=['.cart-item'];var target=delegateEvents(eventSelectors,event.target);var caseClick=3;var quantityRemoved=1;var mainNode;var dataNode;var idProduct;var idProductAttribute;if(event.button===0&&target&&ga.loaded){mainNode=delegateEvents(mainSelector,target);dataNode=mainNode.querySelector('.remove-from-cart');if(dataNode){idProduct=parseInt(dataNode.getAttribute('data-id-product'));idProductAttribute=parseInt(dataNode.getAttribute('data-id-product-attribute'))}
if(!isNaN(idProduct)){if(isNaN(idProductAttribute)){idProductAttribute=0}
idProduct=idProduct+'-'+idProductAttribute;getData(caseClick,idProduct,publicValues.lists.default,null,quantityRemoved)}}}
function eventCartQuantityDelete(event){var eventSelectors=['.remove-from-cart'];var mainSelector=['.cart-item'];var target=delegateEvents(eventSelectors,event.target);var caseClick=3;var mainNode;var idProduct;var idProductAttribute;var quantityRemoved;if(event.button===0&&target&&ga.loaded){idProduct=parseInt(target.getAttribute('data-id-product'));idProductAttribute=parseInt(target.getAttribute('data-id-product-attribute'));mainNode=delegateEvents(mainSelector,target);if(mainNode){quantityRemoved=mainNode.querySelector('.js-cart-line-product-quantity');quantityRemoved=parseInt((quantityRemoved?quantityRemoved.value:null))}
if(!isNaN(idProduct)&&!isNaN(quantityRemoved)){if(isNaN(idProductAttribute)){idProductAttribute=0}
idProduct=idProduct+'-'+idProductAttribute;getData(caseClick,idProduct,publicValues.lists.default,null,quantityRemoved)}}}
function eventPrestashopCheckout(event){var eventSelectors=['#checkout-delivery-step button','#payment-confirmation button'];var target=delegateEvents(eventSelectors,event.target);var currentStepNode;var shippingNode;var paymentNode;var selectedOption;var eventName;if(event.button===0&&target&&ga.loaded){currentStepNode=document.querySelector('.js-current-step');if(currentStepNode.id==='checkout-delivery-step'){shippingNode=document.querySelector('[id^=delivery_option_]:checked');shippingNode=delegateEvents(['.delivery-option'],shippingNode);shippingNode=shippingNode?shippingNode.querySelector('.carrier-name'):null;selectedOption=shippingNode?shippingNode.textContent.trim():null;eventName='Delivery Selected'}else if(currentStepNode.id==='checkout-payment-step'){paymentNode=document.querySelector('[id^=payment-option-]:checked');paymentNode=delegateEvents(['.payment-option'],paymentNode);paymentNode=paymentNode?paymentNode.querySelector('[for^=payment-option-] span'):null;selectedOption=paymentNode?paymentNode.textContent.trim():null;eventName='Payment Selected'}
getCheckOutStep();if(selectedOption&&eventName){onCheckoutOption(selectedOption,eventName)}}}
function eventOpcSuperCheckout(event){var eventSelectors=['#supercheckout_confirm_order'];var mainCarrierSelector=['.highlight'];var mainPaymentSelector=['.highlight'];var target=delegateEvents(eventSelectors,event.target);var shippingOption='';var cgv;var shippingNode;var paymentNode;var paymentMethod;var selectedOption;if(event.button===0&&target&&ga.loaded){cgv=document.querySelector('input[id^=conditions_to_approve]');if(!cgv||cgv.checked){shippingNode=document.querySelector('.supercheckout_shipping_option:checked');if(shippingNode){shippingNode=delegateEvents(mainCarrierSelector,shippingNode);shippingNode=shippingNode.querySelector('label img')||shippingNode.querySelector('label');shippingOption=(shippingNode?shippingNode.getAttribute('alt')||shippingNode.textContent.trim():'');shippingOption=normalizeText(shippingOption)}
paymentNode=document.querySelector('#payment-method input:checked');paymentNode=delegateEvents(mainPaymentSelector,paymentNode);paymentNode=paymentNode.querySelector('label img')||paymentNode.querySelector('label span');paymentMethod=(paymentNode?paymentNode.getAttribute('alt')||paymentNode.textContent.trim():'');paymentMethod=normalizeText(paymentMethod);selectedOption=paymentMethod+' / '+shippingOption;getCheckOutStep();onCheckoutOption(selectedOption,publicValues.opcEventName)}}}
function eventCartOpcSupercheckout(event){var eventSelectors=['.increase_button','.decrease_button','.removeProduct'];var mainSelector=['[id^=product_]'];var target=delegateEvents(eventSelectors,event.target);var targetClassList;var caseClick=2;var quantity=1;var mainNode;var dataNode;var quantityNode;var ids;var idProduct;var idProductAttribute;var indexedProduct;if(event.button===0&&target&&ga.loaded){targetClassList=target.classList;mainNode=delegateEvents(mainSelector,target);if(mainNode){dataNode=mainNode.id;if(dataNode){ids=dataNode.split('_');idProduct=parseInt(ids[1]);idProductAttribute=parseInt(ids[2])}
if(!isNaN(idProduct)){if(isNaN(idProductAttribute)){idProductAttribute=0}
indexedProduct=idProduct+'-'+idProductAttribute;if(targetClassList.contains('decrease_button')||targetClassList.contains('removeProduct')){caseClick=3;if(targetClassList.contains('removeProduct')){quantityNode=mainNode.querySelector('.quantitybox');quantity=parseInt((quantityNode?quantityNode.value:null))}}
getData(caseClick,indexedProduct,publicValues.lists.default,null,quantity)}}}}
function onSearchResults(){var eventName='view_search_results';var eventParams={};var searchTerm;if(document.body.id==='search'){searchTerm=getSearchTerm();if(searchTerm){eventParams.search_term=searchTerm;sendGtagEvent(eventName,eventParams)}}}
function onScrollTracking(products){var eventName='view_item_list';var eventParams;var eventDimensions;var sendNow;if(Array.isArray(products)&&products.length){while(products.length>0){sendNow=products.splice(0,publicValues.trackingFeatures.productSendRate);eventParams={'non_interaction':1,'items':[]};sendNow.forEach(function(product){eventParams.items.push(productLayer(product))});if(publicValues.trackingFeatures.config.remarketing){eventDimensions=setRemarketingDimensions(sendNow,publicValues.ecommPageType);Object.assign(eventParams,eventDimensions)}
sendGtagEvent(eventName,eventParams)}}}
function onProductClick(product,link){var eventName='select_content';var eventParams={'content_type':'product','items':[]};eventParams.items.push(productLayer(product));if(link){privateValues.redirectLink=link;eventParams.event_callback=callbackWithTimeout(function(){redirectLink()},2000)}
sendGtagEvent(eventName,eventParams)}
function onProductView(product){var eventName='view_item';var eventParams={'non_interaction':1,'items':[]};var ecommPageType=publicValues.ecommPageType;var eventDimensions;eventParams.items.push(productLayer(product));if(publicValues.trackingFeatures.config.remarketing){if(product.list_name==='quick_view'){ecommPageType='product'}
eventDimensions=setRemarketingDimensions([product],ecommPageType);Object.assign(eventParams,eventDimensions)}
sendGtagEvent(eventName,eventParams)}
function onSocialAction(network){var eventName='share';var eventParams={'method':network,'event_value':publicValues.trackingFeatures.eventValues.socialAction};if(publicValues.trackingFeatures.goals.socialAction){sendGtagEvent(eventName,eventParams)}}
function onSignUp(){var index=publicValues.trackingFeatures.isGuest;var customerType=publicValues.trackingFeatures.signUpTypes[index];var eventName='sign_up';var eventParams={'method':customerType,'value':publicValues.trackingFeatures.eventValues.signUp};if(publicValues.trackingFeatures.goals.signUp&&publicValues.trackingFeatures.isNewSignUp){sendGtagEvent(eventName,eventParams);publicValues.trackingFeatures.isNewSignUp=0;publicValues.trackingFeatures.isGuest=0}}
function onAddToCart(product,link){var eventName='add_to_cart';var eventParams={'items':[]};var eventDimensions={};var ecommPageType='cart';eventParams.items.push(productLayer(product));if(publicValues.trackingFeatures.config.remarketing){eventDimensions=setRemarketingDimensions([product],ecommPageType);Object.assign(eventParams,eventDimensions)}
if(!publicValues.trackingFeatures.cartAjax&&link){privateValues.redirectLink=link;eventParams.event_callback=callbackWithTimeout(function(){redirectLink()},2000)}
sendGtagEvent(eventName,eventParams)}
function onRemoveFromCart(product,link){var eventName='remove_from_cart';var eventParams={'items':[]};eventParams.items.push(productLayer(product));if(!publicValues.trackingFeatures.cartAjax&&link){privateValues.redirectLink=link;eventParams.event_callback=callbackWithTimeout(function(){redirectLink()},2000)}
sendGtagEvent(eventName,eventParams)}
function onCheckoutProducts(products){var eventName='checkout_progress';var eventParams;var eventDimensions;var sendNow;getCheckOutStep();if(publicValues.pageStep===1){eventName='begin_checkout'}
if(Array.isArray(products)&&products.length){while(products.length>0){sendNow=products.splice(0,publicValues.trackingFeatures.productSendRate);eventParams={'checkout_step':publicValues.pageStep,'items':[]};sendNow.forEach(function(product){eventParams.items.push(productLayer(product))});if(publicValues.trackingFeatures.config.remarketing){eventDimensions=setRemarketingDimensions(sendNow,publicValues.ecommPageType);Object.assign(eventParams,eventDimensions)}
sendGtagEvent(eventName,eventParams)}}}
function onCheckoutOption(checkoutOption,checkoutValue){var eventName='set_checkout_option';var eventParams={'checkout_step':publicValues.pageStep,'checkout_option':checkoutOption,'value':checkoutValue,'items':[]};sendGtagEvent(eventName,eventParams)}
function onAddOrder(order,products,idShop){var eventName='purchase';var adWordsConversionEventName='conversion';var adWordsConversionParams={'transaction_id':order.transaction_id,'value':order.value,'currency':publicValues.trackingFeatures.currency};var productLength=products.length;var firstLoop=1;var eventDimensions;var eventParams;var sendNow;if(Array.isArray(products)&&products.length){while(products.length>0){sendNow=products.splice(0,publicValues.trackingFeatures.productSendRate);eventParams={'items':[],'send_to':publicValues.trackingFeatures.analyticsId};if(firstLoop){eventParams.event_callback=callbackWithTimeout(function(){setOrderInDb(order.transaction_id,idShop)},1000);firstLoop=0}
Object.keys(order).forEach(function(key){if(order[key]!==null&&order[key]!==!1&&order[key]!==''){if(key==='value'&&productLength>publicValues.trackingFeatures.productSendRate){return}
eventParams[key]=order[key]}});sendNow.forEach(function(product){eventParams.items.push(productLayer(product))});if(publicValues.trackingFeatures.config.remarketing){eventDimensions=setRemarketingDimensions(sendNow,publicValues.ecommPageType);Object.assign(eventParams,eventDimensions)}
sendGtagEvent(eventName,eventParams)}
if(publicValues.trackingFeatures.adwordsId&&publicValues.trackingFeatures.adwordsCl){adWordsConversionParams.send_to=publicValues.trackingFeatures.adwordsId+'/'+publicValues.trackingFeatures.adwordsCl;sendGtagEvent(adWordsConversionEventName,adWordsConversionParams)}}}
function sendGtagConfig(configId){var configElement=publicValues.trackingFeatures[configId];var configFeatures=publicValues.trackingFeatures.config;var configParams={};var doNotTrack=(publicValues.trackingFeatures.checkDoNotTrack&&privateValues.doNotTrack);if(publicValues.trackingFeatures.disableInternalTracking||doNotTrack){window['ga-disable-'+publicValues.trackingFeatures.analyticsId]=!0}
if(configId==='analyticsId'){configParams.site_speed_sample_rate=configFeatures.simpleSpeedSampleRate;configParams.anonymize_ip=configFeatures.anonymizeIp;configParams.link_attribution=configFeatures.linkAttribution;if(configFeatures.userIdFeature){configParams.user_id=configFeatures.userIdValue}
if(configFeatures.remarketing){configParams.custom_map={};configParams.custom_map['dimension'+configFeatures.customDimensions.ecommProdId]='ecomm_prodid';configParams.custom_map['dimension'+configFeatures.customDimensions.ecommPageType]='ecomm_pagetype';configParams.custom_map['dimension'+configFeatures.customDimensions.ecommTotalValue]='ecomm_totalvalue';configParams.custom_map['dimension'+configFeatures.customDimensions.ecommCategory]='ecomm_category'}else{configParams.allow_display_features=configFeatures.remarketing}
if(Array.isArray(configFeatures.crossDomainList)&&configFeatures.crossDomainList.length){configParams.linker={'domains':configFeatures.crossDomainList}}
if(configFeatures.optimizeId){configParams.optimize_id=configFeatures.optimizeId}
configParams.currency=publicValues.trackingFeatures.currency}else if(configId==='adwordsId'){configParams.send_page_view=!1}
gtag('config',configElement,configParams)}
function sendGtagEvent(eventName,eventParams){gtag('event',eventName,eventParams)}
function productLayer(product){var productKeys=['id','name','variant','brand','category','list_name','list_position','quantity','price','coupon'];var gaProduct={};productKeys.forEach(function(key){if(product[key]!=null){gaProduct[key]=product[key]}});return gaProduct}
function setRemarketingDimensions(products,ecommPageType){var remarketingDimensions={'ecomm_prodid':[],'ecomm_pagetype':ecommPageType};var ecomm_totalvalue=0;var productPrice=0;var idProduct;products.forEach(function(product){idProduct=product.id;if(publicValues.trackingFeatures.merchantVariant&&product.id_attribute){idProduct=product.id+publicValues.trackingFeatures.merchantVariant+product.id_attribute}
remarketingDimensions.ecomm_prodid.push(publicValues.trackingFeatures.merchantPrefix+idProduct+publicValues.trackingFeatures.merchantSuffix);if(ecommPageType==='cart'||(ecommPageType==='product'&&product.list_name==='product_page')||(ecommPageType==='product'&&product.list_name==='quick_view')||ecommPageType==='purchase'){productPrice=product.price;if(product.quantity){productPrice=productPrice*product.quantity}
ecomm_totalvalue=(ecomm_totalvalue+productPrice);remarketingDimensions.ecomm_totalvalue=parseFloat(ecomm_totalvalue.toFixed(2))}
if(ecommPageType==='category'||ecommPageType==='product'){remarketingDimensions.ecomm_category=product.category}});return remarketingDimensions}
function getSearchTerm(){var searchWordNode;var searchTerm;if(document.body.id==='search'){searchWordNode=document.querySelector('#search_widget input[name=s]');searchTerm=searchWordNode.value||null}
return searchTerm}
function getCheckOutStep(){var currentStepValue=1;var currentStepNode;if(publicValues.isCheckout){if(document.body.id==='checkout'&&publicValues.controllerName!==publicValues.compliantModuleName){currentStepNode=document.querySelector('.js-current-step');switch(currentStepNode.id){case 'checkout-personal-information-step':currentStepValue=2;break;case 'checkout-addresses-step':currentStepValue=3;break;case 'checkout-delivery-step':currentStepValue=4;break;case 'checkout-payment-step':currentStepValue=5;break}}else if(publicValues.controllerName===publicValues.compliantModuleName){currentStepValue=2}
publicValues.pageStep=currentStepValue}}
function getData(caseClick,idProducts,list,link,quantityWanted){var req=new XMLHttpRequest();var url=privateValues.moduleUrl+'rc_pganalytics-ajax.php';var data={'action':'product','products_position':privateValues.productsPosition,'list':list,'quantity_wanted':quantityWanted,'products_list_cache':publicValues.productsListCache};var formData;if(typeof idProducts==='object'){data.id_products=idProducts}else{data.id_products=[idProducts]}
formData=new FormData();formData.append('data',JSON.stringify(data));formData.append('token',publicValues.trackingFeatures.token);req.open('POST',url,!0);req.onreadystatechange=function(){var response;var type;if(req.readyState===4&&req.status===200){type=req.getResponseHeader('Content-Type');if(type==='application/json'){response=JSON.parse(req.responseText);if(typeof response==='object'){if(caseClick===0){onScrollTracking(response)}else if(caseClick===1){onProductClick(response[0],link)}else if(caseClick===2){onAddToCart(response[0],link)}else if(caseClick===3){onRemoveFromCart(response[0],link)}else if(caseClick===4){onProductView(response[0])}}}}};req.send(formData)}
function setOrderInDb(orderId,idShop){var req=new XMLHttpRequest();var url=privateValues.moduleUrl+'rc_pganalytics-ajax.php';var data={'action':'orderComplete','is_order':!0,'id_order':orderId,'id_shop':idShop,'id_customer':publicValues.trackingFeatures.config.userIdValue};var adBlocker=(!window.ga||!window.ga.loaded);var doNotTrack=(publicValues.trackingFeatures.checkDoNotTrack&&privateValues.doNotTrack);var formData;if(doNotTrack||adBlocker){data.action='abortedTransaction';data.doNotTrack=privateValues.doNotTrack;data.adBlocker=adBlocker}
formData=new FormData();formData.append('data',JSON.stringify(data));formData.append('token',publicValues.trackingFeatures.token);req.open('POST',url,!0);req.send(formData)}
function setClientIdInDb(){var clientId;var trackers;var req;var url;var data;var formData;if(window.ga){ga(function(){trackers=ga.getAll();if(Array.isArray(trackers)&&trackers.length){clientId=trackers[0].get('clientId');if(clientId&&clientId!==publicValues.trackingFeatures.clientId){req=new XMLHttpRequest();url=privateValues.moduleUrl+'rc_pganalytics-ajax.php';data={'action':'clientId','id_customer':publicValues.trackingFeatures.config.userIdValue,'id_shop':publicValues.trackingFeatures.idShop,'client_id':clientId};formData=new FormData();formData.append('data',JSON.stringify(data));formData.append('token',publicValues.trackingFeatures.token);req.open('POST',url,!0);req.send(formData)}}})}}
function scrollProductDetection(){var products=document.querySelectorAll('.js-product-miniature');var idProductNotDetected=!1;var idProductAttributeNotDetected=!1;var winHeight=window.innerHeight;var winOffset=window.pageYOffset;var minY=winOffset;var maxY=winOffset+winHeight;var itemTop;var itemBottom;var visibleProduct;var elHeight;var elComputedStyle;var elHeightPadding;var rect;var idProduct;var idProductAttribute;products.forEach(function(product){elHeight=product.clientHeight;if(elHeight){elComputedStyle=getComputedStyle(product);elHeightPadding=parseInt(elComputedStyle.paddingTop)+parseInt(elComputedStyle.paddingBottom);rect=product.getBoundingClientRect();itemTop=rect.top+document.body.scrollTop;itemBottom=itemTop+(elHeight-elHeightPadding);if((itemTop>=minY&&itemTop<maxY)||(itemBottom>=minY&&itemBottom<maxY)){idProduct=parseInt(product.getAttribute('data-id-product'));idProductAttribute=parseInt(product.getAttribute('data-id-product-attribute'));if(isNaN(idProductAttribute)){idProductAttribute=0;idProductAttributeNotDetected=!0}
if(!isNaN(idProduct)){visibleProduct=idProduct+'-'+idProductAttribute;if(privateValues.sentProducts.indexOf(visibleProduct)===-1&&privateValues.sendProducts.indexOf(visibleProduct)===-1){privateValues.sendProducts.push(visibleProduct)}}else{idProductNotDetected=!0}}}})}
function scrollProductPositionDetection(){var products=document.querySelectorAll('.js-product-miniature');var actualPosition=getInitPosition();var productKey;var idProduct;var idProductAttribute;products.forEach(function(product){idProduct=parseInt(product.getAttribute('data-id-product'));idProductAttribute=parseInt(product.getAttribute('data-id-product-attribute'));if(isNaN(idProductAttribute)){idProductAttribute=0}
if(!isNaN(idProduct)){productKey=idProduct+'-'+idProductAttribute;if(!privateValues.productsPosition.hasOwnProperty(productKey)){privateValues.productsPosition[productKey]=actualPosition;actualPosition ++}}})}
function getInitPosition(){var pagination;var itemsNumber;pagination=document.querySelector('.current .disabled.js-search-link');pagination=(pagination?pagination.textContent.trim():1);itemsNumber=publicValues.trackingFeatures.productsPerPage;return(parseInt(itemsNumber)*parseInt(pagination))-parseInt(itemsNumber)+1}
function doneScroll(){var caseClick=0;var list;scrollProductPositionDetection();if(privateValues.sendProducts.length>0){list=checkFilters();getData(caseClick,privateValues.sendProducts,list,null,null);Array.prototype.push.apply(privateValues.sentProducts,privateValues.sendProducts);privateValues.sendProducts=[]}
clearTimeout(privateValues.scrollTimeout)}
function checkFilters(){var list=publicValues.lists.default;var isEnabledFilter=document.querySelector('#js-active-search-filters');if(isEnabledFilter&&isEnabledFilter.className==='active_filters'){list=publicValues.lists.filter}else if(document.body.id==='search'){list=publicValues.lists.search;publicValues.ecommPageType='searchresults'}
return list}
function redirectLink(){if(!privateValues.redirected){privateValues.redirected=!0;window.location=privateValues.redirectLink}}
function callbackWithTimeout(callback,timeout){var called=!1;function fn(){if(!called){called=!0;callback()}}
setTimeout(fn,timeout||1000);return fn}
function normalizeText(text){var filtered='';if(typeof text==='string'){filtered=text.replace(/^\s+|\n+.*/g,'').trim()}
return filtered}
function delegateEvents(selectors,target){var matchMode;if(target){matchMode=target.matches||target.webkitMatchesSelector||target.msMatchesSelector;matchMode=matchMode.name||/function\s+([\w\$]+)\s*\(/.exec(matchMode.toString());if(typeof matchMode!=='string'){matchMode=matchMode?matchMode[1]:''}
if(matchMode){while(target.parentNode!==null){if(target.nodeType===1){for(var i=0;i<selectors.length;i++){if(target[matchMode](selectors[i])){return target}}}
target=target.parentNode}}}}}